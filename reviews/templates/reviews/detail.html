{% extends "base.html" %}
{% load django_bootstrap5 %}
{% bootstrap_css %}
{% bootstrap_javascript %}
{% block content %}
  <div class="container">
    <h1 class="my-3">영화 제목 :
      {{ review.movie_name }}
      || 평점 :
      {{ review.grade }}</h1>
    <p>작성자 :
      {{ review.user.username }}</p>
    <p>제목 :
      {{ review.title }}</p>
    <p>내용 :
      {{ review.content }}</p>

    <p>작성시간 :
      {{ review.created_at|date:'y.m.d H:i' }}</p>
    <p>수정시간 :
      {{ review.updated_at|date:'y.m.d H:i' }}</p>

    {% if request.user == review.user %}
      <div class="d-flex">
        <a href="{% url 'reviews:update' review.pk %}"><input type="submit" class="btn btn-warning " value="수정하기"></a>
        <form action="{% url 'reviews:delete' review.pk %}" method="POST">
          {% csrf_token %}
          <input type='submit' class='btn btn-danger mx-2' value='삭제하기'>
        </form>
      </div>
    {% endif %}

    {% if request.user.is_authenticated %}
      <div class="my-2">
        <form action="{% url 'reviews:comment_create' review.pk %}" method="POST">
          {% csrf_token %}
          {% bootstrap_form comment_form %}
          <input type="submit" value="댓글 작성">
        </form>
      </div>
    {% endif %}
    <hr>
    {% for comment in review.comment_set.all %}
      <p>{{ comment.user.username }}
        |
        {{ comment.content }}</p>
      {% if request.user == comment.user %}
        <form action="{% url 'reviews:comment_delete' review.pk comment.pk%}" method="POST">
          {% csrf_token %}
          <input type="submit" value="DELETE">
        </form>
      {% endif %}
    {% endfor %}
  </div>
{% endblock %}
